-- GENERANDO UNA SUBQUERY PARA MEDIANTE RANDOM() ASIGNAR DE FORMA ALEATORIA 20 CATEGORIAS
CREATE TABLE LINEAS_ACTIVAS_V13 AS
SELECT  CONTRATO, LINEA, PL, FP, CASE
		-- LAS 20 CATEGORIAS ALEATORIAS SON:
		WHEN 0.00<= R20 AND R20<0.05 THEN 1
		WHEN 0.05<= R20 AND R20<0.10 THEN 2
		WHEN 0.10<= R20 AND R20<0.15 THEN 3
		WHEN 0.15<= R20 AND R20<0.20 THEN 4
		WHEN 0.20<= R20 AND R20<0.25 THEN 5
		WHEN 0.25<= R20 AND R20<0.30 THEN 6
		WHEN 0.30<= R20 AND R20<0.35 THEN 7
		WHEN 0.35<= R20 AND R20<0.40 THEN 8
		WHEN 0.40<= R20 AND R20<0.45 THEN 9
		WHEN 0.45<= R20 AND R20<0.50 THEN 10
		WHEN 0.50<= R20 AND R20<0.55 THEN 11
		WHEN 0.55<= R20 AND R20<0.60 THEN 12
		WHEN 0.60<= R20 AND R20<0.65 THEN 13
		WHEN 0.65<= R20 AND R20<0.70 THEN 14
		WHEN 0.70<= R20 AND R20<0.75 THEN 15
		WHEN 0.75<= R20 AND R20<0.80 THEN 16
		WHEN 0.80<= R20 AND R20<0.85 THEN 17
		WHEN 0.85<= R20 AND R20<0.90 THEN 18
		WHEN 0.90<= R20 AND R20<0.95 THEN 19
		ELSE 20 END AS C20
FROM (SELECT *, RANDOM() AS R20
FROM LINEAS_ACTIVAS_V12) AS PQ